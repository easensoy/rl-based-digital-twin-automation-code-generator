<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WMG RL Digital Twin Platform - University of Warwick</title>
    
    <!-- External Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    
    <!-- Essential Stylesheets -->
    <link rel="stylesheet" href="frontend/css/themes/wmg-theme.css">
    <link rel="stylesheet" href="frontend/css/components/dashboard.css">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="wmg-logo"></div>
            <div class="loading-spinner"></div>
            <h2>WMG Digital Twin Platform</h2>
            <p>Initializing Industrial Automation Systems...</p>
        </div>
    </div>

    <!-- Main Application -->
    <div id="application-container" class="application-container hidden">
        
        <!-- Header -->
        <header class="main-header">
            <div class="header-content">
                <div class="header-left">
                    <div class="wmg-brand">
                        <div class="wmg-logo-small"></div>
                        <div class="brand-text">
                            <h1>WMG Digital Twin Platform</h1>
                            <span class="header-subtitle">Industrial Automation & Reinforcement Learning</span>
                        </div>
                    </div>
                </div>
                <div class="header-right">
                    <div class="system-status">
                        <div class="connection-indicator">
                            <div id="connection-status" class="status-dot"></div>
                            <span id="connection-text" class="status-text">Connecting...</span>
                        </div>
                        <div class="performance-summary">
                            OEE: <span id="header-oee">0.0%</span> | 
                            Efficiency: <span id="header-efficiency">0.0%</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Dashboard Layout -->
        <main class="dashboard-layout">
            
            <!-- Left Control Panel -->
            <aside class="left-panel">
                
                <!-- System Status -->
                <section class="control-section">
                    <div class="section-header">
                        <h3 class="section-title">ü§ñ WMG DIGITAL TWIN SYSTEM</h3>
                    </div>
                    <div class="section-content">
                        <div class="status-grid">
                            <div class="status-item">
                                <label>Connection:</label>
                                <span id="system-connection-status" class="status-value connected">‚óè&nbsp;Connected</span>
                            </div>
                            <div class="status-item">
                                <label>Training:</label>
                                <span id="system-training-status" class="status-value active">‚óè&nbsp;Active</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- RL Training Control -->
                <section class="control-section">
                    <div class="section-header">
                        <h3 class="section-title">üß† RL TRAINING CONTROL</h3>
                    </div>
                    
                    <div class="section-content">
                        <div class="control-buttons">
                            <button id="start-training" class="control-btn start-btn">Start Training</button>
                            <button id="stop-training" class="control-btn stop-btn" disabled>Stop Training</button>
                            <button id="reset-system" class="control-btn reset-btn">Reset System</button>
                        </div>
                        
                        <div class="training-metrics">
                            <div class="metric-row">
                                <label>Episode:</label>
                                <span id="current-episode" class="metric-value">525</span>
                            </div>
                            <div class="metric-row">
                                <label>Epsilon:</label>
                                <span id="epsilon-value" class="metric-value">0.072</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Code Generation -->
                <section class="control-section">
                    <div class="section-header">
                        <h3 class="section-title">üìä CODE GENERATION</h3>
                    </div>
                    
                    <div class="section-content">
                        <div class="control-buttons">
                            <button id="generate-code" class="control-btn generate-btn">Generate PLC Code</button>
                            <button id="download-code" class="control-btn download-btn" disabled>Download Code</button>
                        </div>
                    </div>
                </section>
                
            </aside>

            <!-- Central Visualization Area -->
            <section class="main-viewport">
                <div class="viewport-header">
                    <h2 class="viewport-title">Robot Digital Twin</h2>
                    <div class="viewport-controls">
                        <button class="view-button active">3D View</button>
                    </div>
                </div>
                
                <div class="robot-container">
                    <canvas id="robot-canvas" class="robot-canvas"></canvas>
                    
                    <!-- Robot Position Display -->
                    <div class="robot-overlay">
                        <div class="coordinate-display">
                            <div class="coord-item">
                                <label>X:</label>
                                <span id="robot-x">-1.040</span>
                            </div>
                            <div class="coord-item">
                                <label>Y:</label>
                                <span id="robot-y">-1.405</span>
                            </div>
                            <div class="coord-item">
                                <label>Z:</label>
                                <span id="robot-z">0.451</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Right Information Panel -->
            <aside class="right-panel">
                
                <!-- Performance Metrics -->
                <section class="metrics-section">
                    <div class="section-header">
                        <h3 class="section-title">üìà PERFORMANCE METRICS</h3>
                    </div>
                    
                    <div class="section-content">
                        <div class="performance-grid">
                            <div class="perf-item">
                                <label>Cycle Time:</label>
                                <span id="cycle-time" class="perf-value">18.7s</span>
                            </div>
                            <div class="perf-item">
                                <label>Throughput:</label>
                                <span id="throughput" class="perf-value">2.5/min</span>
                            </div>
                            <div class="perf-item">
                                <label>Safety Score:</label>
                                <span id="safety-score" class="perf-value">100.0%</span>
                            </div>
                            <div class="perf-item">
                                <label>Energy Efficiency:</label>
                                <span id="energy-efficiency" class="perf-value">41.5%</span>
                            </div>
                            <div class="perf-item">
                                <label>OEE:</label>
                                <span id="oee-value" class="perf-value">2.0%</span>
                            </div>
                            <div class="perf-item">
                                <label>Reward:</label>
                                <span id="current-reward" class="perf-value">1628.22</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Robot Control -->
                <section class="control-section">
                    <div class="section-header">
                        <h3 class="section-title">ü¶æ ROBOT CONTROL</h3>
                    </div>
                    
                    <div class="section-content">
                        <div class="joint-controls">
                            <div class="joint-control">
                                <label>Base: <span id="joint0-value">-38¬∞</span></label>
                                <input type="range" id="joint0-slider" class="joint-slider base-slider" 
                                       min="-180" max="180" value="-38" step="1">
                            </div>
                            
                            <div class="joint-control">
                                <label>Shoulder: <span id="joint1-value">26¬∞</span></label>
                                <input type="range" id="joint1-slider" class="joint-slider shoulder-slider" 
                                       min="-90" max="90" value="26" step="1">
                            </div>
                            
                            <div class="joint-control">
                                <label>Elbow: <span id="joint2-value">-33¬∞</span></label>
                                <input type="range" id="joint2-slider" class="joint-slider elbow-slider" 
                                       min="-135" max="40" value="-33" step="1">
                            </div>

                            <div class="joint-control">
                                <label>Wrist 1: <span id="joint3-value">-11¬∞</span></label>
                                <input type="range" id="joint3-slider" class="joint-slider wrist1-slider" 
                                       min="-180" max="180" value="-11" step="1">
                            </div>

                            <div class="joint-control">
                                <label>Wrist 2: <span id="joint4-value">60¬∞</span></label>
                                <input type="range" id="joint4-slider" class="joint-slider wrist2-slider" 
                                       min="-120" max="120" value="60" step="1">
                            </div>

                            <div class="joint-control">
                                <label>Tool: <span id="joint5-value">-14¬∞</span></label>
                                <input type="range" id="joint5-slider" class="joint-slider tool-slider" 
                                       min="-360" max="360" value="-14" step="1">
                            </div>
                        </div>
                    </div>
                </section>
                
            </aside>

            <!-- System Log -->
            <footer class="system-log">
                <div class="log-header">
                    <h3 class="log-title">üìã SYSTEM LOG</h3>
                    <div class="log-controls">
                        <button class="log-button" id="clear-log">Clear</button>
                        <button class="log-button" id="export-log">Export</button>
                    </div>
                </div>
                
                <div class="log-container">
                    <div id="log-content" class="log-content">
                        <div class="log-entry info">
                            <span class="log-timestamp">[1:31:45 PM]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">Episode 519: Reward=1682.07</span>
                        </div>
                        <div class="log-entry info">
                            <span class="log-timestamp">[1:31:45 PM]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">Episode 520: Reward=1684.45</span>
                        </div>
                        <div class="log-entry info">
                            <span class="log-timestamp">[1:31:45 PM]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">Episode 521: Reward=1686.84</span>
                        </div>
                        <div class="log-entry info">
                            <span class="log-timestamp">[1:31:46 PM]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">Episode 522: Reward=1677.02</span>
                        </div>
                        <div class="log-entry info">
                            <span class="log-timestamp">[1:31:46 PM]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">Episode 523: Reward=1628.39</span>
                        </div>
                        <div class="log-entry warning">
                            <span class="log-timestamp">[1:31:46 PM]</span>
                            <span class="log-level">WARN</span>
                            <span class="log-message">Episode 524: Reward=1626.10</span>
                        </div>
                        <div class="log-entry info">
                            <span class="log-timestamp">[1:31:46 PM]</span>
                            <span class="log-level">INFO</span>
                            <span class="log-message">Episode 525: Reward=1628.22</span>
                        </div>
                    </div>
                </div>
            </footer>
            
        </main>
    </div>

    <!-- Essential JavaScript Modules -->
    <script src="frontend/js/core/event-dispatcher.js"></script>
    <script src="frontend/js/core/websocket-manager.js"></script>
    <script src="frontend/js/robotics/inverse-kinematics.js"></script>
    <script src="frontend/js/robotics/robot-visualizer.js"></script>
    <script src="frontend/js/robotics/robot-controller.js"></script>
    <script src="frontend/main.js"></script>
</body>
</html>